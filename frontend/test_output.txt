
> frontend@0.0.0 test C:\Users\Cheney\Documents\Github\LearningSong\frontend
> jest "tests/LineLevelSync.integration.test.tsx"

FAIL tests/LineLevelSync.integration.test.tsx
  Line-Level Sync Integration Tests
    ‚àö displays sync mode toggle when line cues are available (180 ms)
    ‚àö switches between word and line sync modes (315 ms)
    ‚àö persists sync mode preference to localStorage (197 ms)
    ‚àö restores sync mode preference on page load (87 ms)
    ‚àö clicking a line makes it interactive (138 ms)
    √ó renders lines in line sync mode during playback (1106 ms)
    √ó calls scrollIntoView when lines are rendered in line sync mode (1090 ms)

  ‚óè Line-Level Sync Integration Tests ‚Ä∫ renders lines in line sync mode during playback

    Found multiple elements with the text: /Second line of lyrics/

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33maria-current[39m=[32m"time"[39m
      [33maria-describedby[39m=[32m"current-line-description"[39m
      [33maria-label[39m=[32m"Lyric line: Second line of lyrics. Click to seek to 0:02"[39m
      [33mclass[39m=[32m"p-2 rounded-md transition-all duration-300 cursor-pointer text-lg leading-snug focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary/15 font-medium text-foreground scale-[1.02] shadow-sm ring-1 ring-primary/20 hover:bg-muted/80"[39m
      [33mrole[39m=[32m"button"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [0mSecond line of lyrics[0m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33maria-atomic[39m=[32m"true"[39m
      [33maria-live[39m=[32m"polite"[39m
      [33mclass[39m=[32m"sr-only"[39m
    [36m>[39m
      [0mNow singing: Second line of lyrics[0m
    [36m</div>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"min-h-screen bg-background"[39m
        [36m>[39m
          [36m<nav[39m
            [33maria-label[39m=[32m"Skip links"[39m
            [33mclass[39m=[32m"sr-only focus-within:not-sr-only"[39m
          [36m>[39m
            [36m<a[39m
              [33mclass[39m=[32m"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary focus:text-primary-foreground focus:rounded-md focus:ring-2 focus:ring-ring focus:ring-offset-2"[39m
              [33mhref[39m=[32m"#main-content"[39m
            [36m>[39m
              [0mSkip to main content[0m
            [36m</a>[39m
            [36m<a[39m
              [33mclass[39m=[32m"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-48 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary focus:text-primary-foreground focus:rounded-md focus:ring-2 focus:ring-ring focus:ring-offset-2"[39m
              [33mhref[39m=[32m"#audio-player"[39m
            [36m>[39m
              [0mSkip to audio player[0m
            [36m</a>[39m
          [36m</nav>[39m
          [36m<header[39m
            [33mclass[39m=[32m"border-b"[39m
            [33mrole[39m=[32m"banner"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"container mx-auto px-4 py-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"text-left"[39m
                [36m>[39m
                  [36m<h1[39m
                    [33mclass[39m=[32m"text-3xl font-bold tracking-tight"[39m
                  [36m>[39m
                    [0mLearningSong[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mclass[39m=[32m"text-muted-foreground mt-1"[39m
                  [36m>[39m
                    [0mYour song is ready to play[0m
                  [36m</p>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center gap-4"[39m
                [36m>[39m
                  [36m<nav[39m
                    [33maria-label[39m=[32m"Main navigation"[39m
                    [33mclass[39m=[32m"flex items-center gap-1 sm:gap-2"[39m
                  [36m>[39m
                    [36m<a[39m
                      [33maria-current[39m=[32m"page"[39m
                      [33mclass[39m=[32m"px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground font-medium"[39m
                      [33mdata-discover[39m=[32m"true"[39m
                      [33mhref[39m=[32m"/"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"hidden sm:inline"[39m
                      [36m>[39m
                        [0mText Input[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"sm:hidden"[39m
                      [36m>[39m
                        [0mInput[0m
                      [36m</span>[39m
                    [36m</a>[39m
                    [36m<a[39m
                      [33mclass[39m=[32m"px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 text-muted-foreground"[39m
                      [33mdata-discover[39m=[32m"true"[39m
                      [33mhref[39m=[32m"/lyrics-edit"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"hidden sm:inline"[39m
                      [36m>[39m
                        [0mLyrics Editing[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"sm:hidden"[39m
                      [36m>[39m
                        [0mLyrics[0m
                      [36m</span>[39m
                    [36m</a>[39m
                    [36m<a[39m
                      [33mclass[39m=[32m"px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 text-muted-foreground"[39m
                      [33mdata-discover[39m=[32m"true"[39m
                      [33mhref[39m=[32m"/playback"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"hidden sm:inline"[39m
                      [36m>[39m
                        [0mSong Playback[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"sm:hidden"[39m
                      [36m>[39m
                        [0mPlayback[0m
                      [36m</span>[39m
                    [36m</a>[39m
                    [36m<a[39m
                      [33mclass[39m=[32m"px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 text-muted-foreground"[39m
                      [33mdata-discover[39m=[32m"true"[39m
                      [33mhref[39m=[32m"/history"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"hidden sm:inline"[39m
                      [36m>[39m
                        [0mMy Songs[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"sm:hidden"[39m
                      [36m>[39m
                        [0mSongs[0m
                      [36m</span>[39m
                    [36m</a>[39m
                  [36m</nav>[39m
                  [36m<div[39m
                    [33maria-atomic[39m=[32m"true"[39m
                    [33maria-live[39m=[32m"polite"[39m
                    [33mclass[39m=[32m"space-y-1"[39m
                    [33mrole[39m=[32m"status"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center space-x-2 text-sm font-medium text-green-700 dark:text-green-500"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33maria-label[39m=[32m"3 of 3 songs remaining today"[39m
                      [36m>[39m
                        [0müéµ [0m
                        [0m3[0m
                        [0m/[0m
                        [0m3[0m
                        [0m songs remaining today[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</header>[39m
          [36m<main[39m...

    [0m [90m 214 |[39m     renderWithProviders()
     [90m 215 |[39m
    [31m[1m>[22m[39m[90m 216 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 217 |[39m       [36mconst[39m secondLine [33m=[39m screen[33m.[39mgetByText([35m/Second line of lyrics/[39m)
     [90m 218 |[39m       expect(secondLine)[33m.[39mtoBeInTheDocument()
     [90m 219 |[39m       expect(secondLine)[33m.[39mtoHaveAttribute([32m'aria-current'[39m[33m,[39m [32m'time'[39m)[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at tests/LineLevelSync.integration.test.tsx:216:18
      at tests/LineLevelSync.integration.test.tsx:8:71
      at __awaiter (tests/LineLevelSync.integration.test.tsx:4:12)
      at Object.<anonymous> (tests/LineLevelSync.integration.test.tsx:210:68)

  ‚óè Line-Level Sync Integration Tests ‚Ä∫ calls scrollIntoView when lines are rendered in line sync mode

    Found multiple elements with the text: /First line of lyrics/

    Here are the matching elements:

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33maria-current[39m=[32m"time"[39m
      [33maria-describedby[39m=[32m"current-line-description"[39m
      [33maria-label[39m=[32m"Lyric line: First line of lyrics. Click to seek to 0:01"[39m
      [33mclass[39m=[32m"p-2 rounded-md transition-all duration-300 cursor-pointer text-lg leading-snug focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary/15 font-medium text-foreground scale-[1.02] shadow-sm ring-1 ring-primary/20 hover:bg-muted/80"[39m
      [33mrole[39m=[32m"button"[39m
      [33mtabindex[39m=[32m"0"[39m
    [36m>[39m
      [0mFirst line of lyrics[0m
    [36m</div>[39m

    Ignored nodes: comments, script, style
    [36m<div[39m
      [33maria-atomic[39m=[32m"true"[39m
      [33maria-live[39m=[32m"polite"[39m
      [33mclass[39m=[32m"sr-only"[39m
    [36m>[39m
      [0mNow singing: First line of lyrics[0m
    [36m</div>[39m

    (If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"min-h-screen bg-background"[39m
        [36m>[39m
          [36m<nav[39m
            [33maria-label[39m=[32m"Skip links"[39m
            [33mclass[39m=[32m"sr-only focus-within:not-sr-only"[39m
          [36m>[39m
            [36m<a[39m
              [33mclass[39m=[32m"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary focus:text-primary-foreground focus:rounded-md focus:ring-2 focus:ring-ring focus:ring-offset-2"[39m
              [33mhref[39m=[32m"#main-content"[39m
            [36m>[39m
              [0mSkip to main content[0m
            [36m</a>[39m
            [36m<a[39m
              [33mclass[39m=[32m"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-48 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary focus:text-primary-foreground focus:rounded-md focus:ring-2 focus:ring-ring focus:ring-offset-2"[39m
              [33mhref[39m=[32m"#audio-player"[39m
            [36m>[39m
              [0mSkip to audio player[0m
            [36m</a>[39m
          [36m</nav>[39m
          [36m<header[39m
            [33mclass[39m=[32m"border-b"[39m
            [33mrole[39m=[32m"banner"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"container mx-auto px-4 py-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"text-left"[39m
                [36m>[39m
                  [36m<h1[39m
                    [33mclass[39m=[32m"text-3xl font-bold tracking-tight"[39m
                  [36m>[39m
                    [0mLearningSong[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mclass[39m=[32m"text-muted-foreground mt-1"[39m
                  [36m>[39m
                    [0mYour song is ready to play[0m
                  [36m</p>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center gap-4"[39m
                [36m>[39m
                  [36m<nav[39m
                    [33maria-label[39m=[32m"Main navigation"[39m
                    [33mclass[39m=[32m"flex items-center gap-1 sm:gap-2"[39m
                  [36m>[39m
                    [36m<a[39m
                      [33maria-current[39m=[32m"page"[39m
                      [33mclass[39m=[32m"px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground font-medium"[39m
                      [33mdata-discover[39m=[32m"true"[39m
                      [33mhref[39m=[32m"/"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"hidden sm:inline"[39m
                      [36m>[39m
                        [0mText Input[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"sm:hidden"[39m
                      [36m>[39m
                        [0mInput[0m
                      [36m</span>[39m
                    [36m</a>[39m
                    [36m<a[39m
                      [33mclass[39m=[32m"px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 text-muted-foreground"[39m
                      [33mdata-discover[39m=[32m"true"[39m
                      [33mhref[39m=[32m"/lyrics-edit"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"hidden sm:inline"[39m
                      [36m>[39m
                        [0mLyrics Editing[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"sm:hidden"[39m
                      [36m>[39m
                        [0mLyrics[0m
                      [36m</span>[39m
                    [36m</a>[39m
                    [36m<a[39m
                      [33mclass[39m=[32m"px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 text-muted-foreground"[39m
                      [33mdata-discover[39m=[32m"true"[39m
                      [33mhref[39m=[32m"/playback"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"hidden sm:inline"[39m
                      [36m>[39m
                        [0mSong Playback[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"sm:hidden"[39m
                      [36m>[39m
                        [0mPlayback[0m
                      [36m</span>[39m
                    [36m</a>[39m
                    [36m<a[39m
                      [33mclass[39m=[32m"px-2 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 text-muted-foreground"[39m
                      [33mdata-discover[39m=[32m"true"[39m
                      [33mhref[39m=[32m"/history"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"hidden sm:inline"[39m
                      [36m>[39m
                        [0mMy Songs[0m
                      [36m</span>[39m
                      [36m<span[39m
                        [33mclass[39m=[32m"sm:hidden"[39m
                      [36m>[39m
                        [0mSongs[0m
                      [36m</span>[39m
                    [36m</a>[39m
                  [36m</nav>[39m
                  [36m<div[39m
                    [33maria-atomic[39m=[32m"true"[39m
                    [33maria-live[39m=[32m"polite"[39m
                    [33mclass[39m=[32m"space-y-1"[39m
                    [33mrole[39m=[32m"status"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"flex items-center space-x-2 text-sm font-medium text-green-700 dark:text-green-500"[39m
                    [36m>[39m
                      [36m<span[39m
                        [33maria-label[39m=[32m"3 of 3 songs remaining today"[39m
                      [36m>[39m
                        [0müéµ [0m
                        [0m3[0m
                        [0m/[0m
                        [0m3[0m
                        [0m songs remaining today[0m
                      [36m</span>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</header>[39m
          [36m<main[39m...

    [0m [90m 233 |[39m     renderWithProviders()
     [90m 234 |[39m
    [31m[1m>[22m[39m[90m 235 |[39m     [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 236 |[39m       expect(screen[33m.[39mgetByText([35m/First line of lyrics/[39m))[33m.[39mtoBeInTheDocument()
     [90m 237 |[39m     })
     [90m 238 |[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at tests/LineLevelSync.integration.test.tsx:235:18
      at tests/LineLevelSync.integration.test.tsx:8:71
      at __awaiter (tests/LineLevelSync.integration.test.tsx:4:12)
      at Object.<anonymous> (tests/LineLevelSync.integration.test.tsx:226:83)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 5 passed, 7 total
Snapshots:   0 total
Time:        6.396 s
Ran all test suites matching tests/LineLevelSync.integration.test.tsx.
‚ÄâELIFECYCLE‚Äâ Test failed. See above for more details.
